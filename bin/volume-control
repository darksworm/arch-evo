#!/usr/bin/env bash
# Volume control with dunstify OSD feedback
# Usage: volume-control {up|down|mute}
set -euo pipefail

case "${1:-}" in
    up)
        pamixer -i 5
        ;;
    down)
        pamixer -d 5
        ;;
    mute)
        pamixer -t
        ;;
    *)
        echo "Usage: volume-control {up|down|mute}"
        exit 1
        ;;
esac

volume=$(pamixer --get-volume)
muted=$(pamixer --get-mute || true)

if [[ "${muted}" == "true" ]]; then
    icon="󰝟"
    dunstify -a "volume" -u low -h string:x-dunst-stack-tag:volume \
        -h int:value:0 "$icon Volume: muted" -t 1500
else
    if (( volume >= 66 )); then
        icon="󰕾"
    elif (( volume >= 33 )); then
        icon="󰖀"
    else
        icon="󰕿"
    fi
    dunstify -a "volume" -u low -h string:x-dunst-stack-tag:volume \
        -h int:value:"$volume" "$icon Volume: ${volume}%" -t 1500
fi
